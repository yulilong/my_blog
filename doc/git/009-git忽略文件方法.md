[TOC]



# git忽略文件的方式

## 1. `.gitignore` 文件(整个仓库都忽略)

 文件指定了 Git 追踪时应忽略的文件。在文件里配置忽略规则，同时把 `.gitignore` 文件加入版本管理。

文件 `.gitignore` 的格式规范如下：

- 所有空行或者以 `#` 开头的行都会被 Git 忽略。
- 可以使用标准的 glob 模式匹配，它会递归地应用在整个工作区中。
- 匹配模式可以以（`/`）开头防止递归。
- 匹配模式可以以（`/`）结尾指定目录。
- 要忽略指定模式以外的文件或目录，可以在模式前加上叹号（`!`）取反。

所谓的 glob 模式是指 shell 所使用的简化了的正则表达式。 星号（`*`）匹配零个或多个任意字符；`[abc]` 匹配任何一个列在方括号中的字符 （这个例子要么匹配一个 a，要么匹配一个 b，要么匹配一个 c）； 问号（`?`）只匹配一个任意字符；如果在方括号中使用短划线分隔两个字符， 表示所有在这两个字符范围内的都可以匹配（比如 `[0-9]` 表示匹配所有 0 到 9 的数字）。 使用两个星号（`**`）表示匹配任意中间目录，比如 `a/**/z` 可以匹配 `a/z` 、 `a/b/z` 或 `a/b/c/z` 等。

一个 `.gitignore` 文件的例子：

```bash
# 忽略所有的 .a 文件
*.a
# 但跟踪所有的 lib.a，即便你在前面忽略了 .a 文件
!lib.a
# 只忽略当前目录下的 TODO 文件，而不忽略 subdir/TODO
/TODO
# 忽略任何目录下名为 build 的文件夹
build/
# 忽略 doc/notes.txt，但不忽略 doc/server/arch.txt
doc/*.txt
# 忽略 doc/ 目录及其所有子目录下的 .pdf 文件
doc/**/*.pdf
```

**注意**：    
1、GitHub 有一个十分详细的针对数十种项目及语言的 `.gitignore` 文件列表， 你可以在 https://github.com/github/gitignore 找到它。      
2、在最简单的情况下，一个仓库可能只根目录下有一个 `.gitignore` 文件，它递归地应用到整个仓库中。 然而，子目录下也可以有额外的 `.gitignore` 文件。子目录中的 `.gitignore` 文件中的规则只作用于它所在的目录中。 （Linux 内核的源码库拥有 206 个 `.gitignore` 文件。）

参考：

[Git 基础 - 记录每次更新到仓库](https://git-scm.com/book/zh/v2/Git-%E5%9F%BA%E7%A1%80-%E8%AE%B0%E5%BD%95%E6%AF%8F%E6%AC%A1%E6%9B%B4%E6%96%B0%E5%88%B0%E4%BB%93%E5%BA%93)

[gitignore说明](https://git-scm.com/docs/gitignore/zh_HANS-CN)

## 2. 本机开发忽略`.git/info/exclude`

单个仓库下忽略，不会同步该设置至远程仓库，只在本机起作用；配置方法是直接编辑仓库根目录下的`.git/info/exclude`文件，把要忽略的规则直接写入。文件内容规则跟`.gitignore`文件一样

## 3. 忽略已跟踪文件改动：update-index --assume-unchanged

对于已经提交、跟踪的文件，如果想要忽略修改的记录，可以使用这个命令。使用命令后，会标记这个文件，让git认为这个文件没有修改。如果想要git从新追踪这个文件，则需要使用命令从新标记。

```bash
# 设置忽略文件修改
git update-index --assume-unchanged doc/test.txt

# 取消文件忽略
git update-index --no-assume-unchanged doc/test.txt
# 如果忽略的文件多了，可以使用以下命令查看忽略列表
git ls-files -v | grep '^h\ '
# 显示文件路径
git ls-files -v | grep '^h\ ' | awk '{print $2}'
# 所有被忽略的文件，取消忽略的方法
git ls-files -v | grep '^h' | awk '{print $2}' |xargs git update-index --no-assume-unchanged  
```



